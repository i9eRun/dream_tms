/*
 * File: app/view/tpop/tpop1001ViewController.js
 *
 * This file was generated by Sencha Architect version 4.3.7.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 7.9.x Classic library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 7.9.x Classic. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('dream.view.tpop.tpop1001ViewController', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.tpop.tpop1001',

    onGridpanelAfterRender_tpop1001_user_grid: function(component, eOpts) {
        const store = component.getStore();
        store.getProxy().setUrl(dream.util.Common.BASE_URL + '/tpop/user/search');
        store.reload();
    },

    onGridpanelItemDblClick_tpop1001_user_grid: function(dataview, record, item, index, e, eOpts) {
        const view = this.getView();
        view.fireEvent('selectUser', view, record);
        view.close();
    },

    onTpop1001_search_btnClick: function(button, e, eOpts) {
        const view = this.getView();
        const store = view.lookupReference('tpop1001_user_grid').getStore();
        const keyword = Ext.getCmp('tpop1001_keyword').getValue();
        const use_yn = Ext.getCmp('tpop1001_useyn').getValue();

        store.getProxy().setExtraParams({
            search_keyword: keyword,
            cbo_use_yn_sch: use_yn
        });

        store.reload();
    },

    onTpop1001_confirmClick: function(button, e, eOpts) {
        const view = this.getView();
        const grid = view.lookupReference('tpop1001_user_grid');
        const selection = grid.getSelectionModel().getSelection();

        if (selection.length === 0) {
            Ext.Msg.alert('알림', '사용자를 선택해주세요.');
            return;
        }

        const record = selection[0];


        view.fireEvent('selectUser', view, record);

        view.close();
    },

    onTpop1001_useynAfterRender: function(component, eOpts) {
        dream.util.Common.setFlagCombo(component,"사용","전체","");
    }

});
